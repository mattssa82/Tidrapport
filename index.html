<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tidrapport</title>

<!-- App metadata -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0e6677">
<link rel="icon" href="icon-512.png">

<!-- PDF & styling -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root{
  --brand:#0e6677;--bg:#f6f7f9;--card:#fff;--text:#1f2937;--muted:#6b7280;--line:#e5e7eb;
  --ok:#16a34a;--warn:#b45309;--danger:#b91c1c;--accent:#0a515f;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
header{background:var(--brand);color:#fff;padding:1rem 1.2rem;display:flex;justify-content:space-between;align-items:center}
header h1{margin:0;font-size:1.3rem}
nav button{background:none;border:none;color:#fff;font-size:1.4rem;cursor:pointer}
main{padding:1rem;max-width:980px;margin:auto}
section{margin-bottom:1.5rem;background:var(--card);border-radius:.8rem;padding:1rem;box-shadow:0 1px 2px rgba(0,0,0,.05)}
h2{font-size:1.1rem;margin:.3rem 0 1rem 0;color:var(--accent)}
label{display:block;margin-top:.5rem;font-weight:600}
input,select,textarea{width:100%;padding:.5rem;border:1px solid var(--line);border-radius:.4rem;margin-top:.2rem}
button.primary{background:var(--brand);color:#fff;padding:.6rem 1rem;border:0;border-radius:.5rem;cursor:pointer;margin-top:.8rem}
button.primary:hover{background:var(--accent)}
table{width:100%;border-collapse:collapse;margin-top:1rem}
th,td{border:1px solid var(--line);padding:.45rem;font-size:.9rem;text-align:left}
th{background:#eef2f7}
footer{text-align:center;padding:1rem 0;color:var(--muted);font-size:.85rem}
.badge{display:inline-flex;align-items:center;gap:.35rem;padding:.25rem .6rem;background:#eef2f7;border-radius:.5rem}
.ok{color:var(--ok)}.warn{color:var(--warn)}.danger{color:var(--danger)}
.menu{display:grid;gap:.4rem;margin-bottom:1rem}
.menu button{display:flex;align-items:center;gap:.6rem;background:#fff;border:1px solid var(--line);border-radius:.5rem;padding:.6rem 1rem;font-size:.95rem;cursor:pointer;text-align:left}
.menu button:hover{background:#f0f0f0}
.menu .icon{width:1.3rem;text-align:center}
.hidden{display:none}
</style>
</head>

<body>
<header>
  <h1>ğŸ•’ Tidrapport</h1>
  <nav>
    <button id="menuBtn">â˜°</button>
  </nav>
</header>

<main>
  <!-- Meny -->
  <div id="menu" class="menu">
    <button onclick="showSection('month')"><span class="icon">ğŸ“…</span>MÃ¥nad</button>
    <button onclick="showSection('year')"><span class="icon">ğŸ“†</span>Ã…r</button>
    <button onclick="showSection('search')"><span class="icon">ğŸ”</span>SÃ¶k</button>

    <details>
      <summary><span class="icon">ğŸ“¤</span>Export</summary>
      <button onclick="exportMonthCSV()">ğŸ“‘ MÃ¥nadsrapport (CSV)</button>
      <button onclick="exportYearCSV()">ğŸ—“ï¸ Ã…rsrapport (CSV)</button>
      <button onclick="exportMonthPDF()">ğŸ“ PDF MÃ¥nadsrapport</button>
      <button onclick="exportYearPDF()">ğŸ“ PDF Ã…rsrapport</button>
    </details>

    <details>
      <summary><span class="icon">ğŸ“¥</span>Import</summary>
      <button onclick="importCSV()">ğŸ“‘ Importera CSV</button>
      <button onclick="importBackup()">â˜ï¸ Importera JSON (backup)</button>
    </details>

    <button onclick="showSection('settings')"><span class="icon">âš™ï¸</span>InstÃ¤llningar</button>
    <button onclick="quickBackup()"><span class="icon">â˜ï¸</span>Backup</button>
    <a href="help.html"><button><span class="icon">â„¹ï¸</span>HjÃ¤lp</button></a>
  </div>

  <!-- Sektion: MÃ¥nad -->
  <section id="month" class="active">
    <h2>ğŸ“… Tidrapport fÃ¶r aktuell mÃ¥nad</h2>
    <form id="timeForm">
      <label>Datum<input type="date" id="date"></label>
      <label>Kategori<select id="category">
        <option>Ordinarie tid</option><option>Flextid</option><option>Ã–vertid <2</option>
        <option>Ã–vertid 2></option><option>Ã–vertid Helg</option><option>Traktamente</option>
        <option>Semester</option><option>ATF</option><option>Sjuk</option>
        <option>FÃ¶rÃ¤ldraledig</option><option>VAB</option>
      </select></label>
      <label>Timmar<input type="number" step="0.25" id="hours"></label>
      <label>KÃ¶rtid<input type="number" step="0.25" id="drive"></label>
      <label>Projekt<input type="text" id="project"></label>
      <label>Beskrivning<textarea id="desc"></textarea></label>
      <button type="button" class="primary" onclick="addRow()">LÃ¤gg till</button>
    </form>
    <table id="timeTable">
      <thead>
        <tr><th>Datum</th><th>Kategori</th><th>Timmar</th><th>KÃ¶rtid</th><th>Projekt</th><th>Beskrivning</th><th>Summa</th><th>âš™ï¸</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- Sektion: Ã…r -->
  <section id="year" class="hidden">
    <h2>ğŸ“† Ã…rsÃ¶versikt</h2>
    <div id="yearSummary"></div>
  </section>

  <!-- Sektion: SÃ¶k -->
  <section id="search" class="hidden">
    <h2>ğŸ” SÃ¶k i alla mÃ¥nader</h2>
    <input type="text" id="searchInput" placeholder="SÃ¶k i datum, projekt, kategori, beskrivning...">
    <button class="primary" onclick="runSearch()">SÃ¶k</button>
    <table id="searchResults" class="hidden">
      <thead><tr><th>Datum</th><th>Kategori</th><th>Timmar</th><th>Projekt</th><th>Beskrivning</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- Sektion: InstÃ¤llningar -->
  <section id="settings" class="hidden">
    <h2>âš™ï¸ InstÃ¤llningar</h2>
    <label>ğŸ¢ FÃ¶retag<input type="text" id="company"></label>
    <label>ğŸ‘¤ Namn<input type="text" id="username"></label>
    <label>ğŸ†” Anst.nr<input type="text" id="empid"></label>
    <label>ğŸ”‘ Ã„gar-ID<input type="text" id="owner"></label>
    <label>ğŸ“… Ã…r<input type="number" id="yearInput" min="2020" max="2100"></label>
    <label>ğŸ“ Noteringar<textarea id="notes"></textarea></label>
    <label><input type="checkbox" id="autoBackup"> ğŸ”„ Auto-backup (1h)</label>
    <button class="primary" onclick="saveSettings()">Spara instÃ¤llningar</button>
  </section>

  <footer>Byggd med â¤ï¸ av ChatGPT &amp; Martin Mattsson</footer>
</main>

<script src="app.js"></script>
<script src="export.js"></script>
<script src="backup.js"></script>
<script>
if("serviceWorker" in navigator){navigator.serviceWorker.register("sw.js");}
</script>
</body>
</html>