<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Tidrapport</title>
<meta name="theme-color" content="#0e6677" />
<link rel="manifest" href="manifest.json" />
<script src="lucide.min.js"></script>

<!-- Tidrapport v10.3 | i samarbete med ChatGPT & Martin Mattsson -->

<style>
:root{
  --bg-main:#f5f7f8;
  --bg-header:#0e6677;
  --bg-card:#fff;
  --text-main:#1a1a1a;
  --border-col:#cfcfcf;
}
body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
  background:var(--bg-main);
  color:var(--text-main);
}
header.app-header{
  background:var(--bg-header);
  color:#fff;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:.75rem 1rem;
}
header.app-header h1{font-size:1.1rem;font-weight:600;margin:0;}
header.app-header .header-left{display:flex;align-items:center;gap:.75rem;}
header.app-header .icon-btn{background:none;border:0;color:#fff;cursor:pointer;}
header.app-header .help-link{color:#fff;text-decoration:none;display:flex;align-items:center;gap:.4rem;font-size:.9rem;}
.layout{display:flex;min-height:calc(100vh - 52px);}
aside#sidePanel{
  background:var(--bg-header);
  color:#fff;
  width:260px;
  padding:1rem;
}
aside#sidePanel h2{font-size:.9rem;margin:1rem 0 .5rem 0;}
aside#sidePanel label{display:block;font-size:.8rem;margin-bottom:.5rem;}
aside#sidePanel input,aside#sidePanel select,aside#sidePanel textarea{
  width:100%;font-size:.8rem;padding:.4rem .5rem;border-radius:.4rem;
  border:1px solid rgba(255,255,255,.4);background:rgba(255,255,255,.15);color:#fff;
}
.side-buttons{display:grid;gap:.5rem;margin-top:.75rem;}
.side-action{display:flex;align-items:center;gap:.5rem;border:0;border-radius:.4rem;padding:.5rem .6rem;
  background:#fff;color:var(--bg-header);cursor:pointer;font-size:.8rem;font-weight:500;text-align:left;}
.side-action.danger{background:#c0392b;color:#fff;}
main#mainArea{flex:1;padding:1rem;box-sizing:border-box;}
.entry-card{background:#fff;border:1px solid var(--border-col);border-radius:.6rem;padding:1rem;margin-bottom:1rem;}
.entry-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:.75rem;}
.entry-grid label{font-size:.8rem;font-weight:500;color:#444;display:flex;flex-direction:column;gap:.3rem;}
.entry-grid input,.entry-grid select,.entry-grid textarea{font-size:.9rem;padding:.5rem;border:1px solid #999;border-radius:.4rem;}
.button-row{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:1rem;}
.button-row button{display:flex;align-items:center;gap:.4rem;border:0;border-radius:.5rem;padding:.6rem .8rem;
  font-size:.85rem;font-weight:500;background:var(--bg-header);color:#fff;cursor:pointer;}
.button-row .cancel-btn{background:#999;}
.table-wrap{background:#fff;border:1px solid var(--border-col);border-radius:.6rem;overflow-x:auto;margin-top:1rem;}
table{width:100%;border-collapse:collapse;font-size:.8rem;}
th,td{padding:.5rem;border:1px solid var(--border-col);text-align:left;}
th{background:#ececec;font-weight:600;}
tfoot td{background:#fafafa;font-weight:600;}
.dagstatus--grön{background:#dff8dd!important;}
.dagstatus--orange_under,.dagstatus--orange_absence{background:#fff2cc!important;}
.dagstatus--saknas{background:#ffd6d6!important;}
.dagstatus--helg{background:#eef3ff!important;}
.dagstatus--röddag{background:#ffe6e6!important;}
.year-card{margin-top:2rem;background:#fff;border:1px solid var(--border-col);border-radius:.6rem;padding:1rem;}
@media(max-width:800px){
  aside#sidePanel{position:fixed;inset:0 auto 0 0;width:260px;transform:translateX(-100%);
    transition:.2s;z-index:999;background:#0e6677;overflow:auto;}
  aside#sidePanel.open{transform:translateX(0);}
}
</style>
</head>

<body>
<header class="app-header">
  <div class="header-left">
    <button id="menuToggleBtn" class="icon-btn" aria-label="Meny"><i data-lucide="menu"></i></button>
    <h1>Tidrapport</h1>
  </div>
  <a class="help-link" href="help.html" target="_blank"><i data-lucide="info"></i><span>Hjälp</span></a>
</header>

<div class="layout">
<aside id="sidePanel">
  <h2>Period</h2>
  <label>År<select id="yearSelect"></select></label>
  <label>Månad<select id="monthSelect"></select></label>
  <h2>Backup / Export</h2>
  <div class="side-buttons">
    <input type="file" id="importFileInput" accept=".json" />
    <button class="side-action" id="manualBackupBtn"><i data-lucide="upload-cloud"></i><span>Backup nu</span></button>
    <button class="side-action" id="exportCsvBtn"><i data-lucide="file-spreadsheet"></i><span>Exportera CSV</span></button>
    <button class="side-action" id="exportPdfBtn"><i data-lucide="file-text"></i><span>Exportera PDF</span></button>
    <button class="side-action" id="exportYearBtn"><i data-lucide="calendar"></i><span>Exportera Årsöversikt</span></button>
    <button class="side-action" id="openSearchBtn"><i data-lucide="search"></i><span>Sök & filtrera</span></button>
    <button class="side-action danger" id="clearAllBtn"><i data-lucide="trash-2"></i><span>Rensa ALL data</span></button>
  </div>

  <h2>Inställningar</h2>
  <label>Företag<input id="companyInput" type="text" /></label>
  <label>Namn<input id="nameInput" type="text" /></label>
  <label>Anst.nr<input id="anstnrInput" type="text" /></label>
  <label>Röda dagar<input id="redDaysInput" type="text" placeholder="2025-06-06, 2025-12-26" /></label>
  <label>Röddag timmar<input id="redDayHoursInput" type="number" step="0.25" min="0" /></label>
  <label><input id="showRedDaysChk" type="checkbox" /> Visa röda dagar</label>
  <label><input id="autoBackupChk" type="checkbox" /> Auto-backup (COV)</label>
  <button class="side-action" id="saveSettingsBtn"><i data-lucide="save"></i><span>Spara</span></button>
  <p style="font-size:.7rem;opacity:.8;margin-top:1rem;">Tidrapport v10.3<br/>i samarbete med ChatGPT &amp; Martin Mattsson</p>
</aside>

<main id="mainArea">
<section class="entry-card">
  <div class="entry-grid">
    <label>Datum<input id="dateInput" type="date" /></label>
    <label>Kategori<select id="catMainSelect"></select></label>
    <label>Tid (h)<input id="catMainHours" type="number" step="0.25" min="0" /></label>
    <label>Extra kategori 1<div><select class="catExtraSelect" data-extra-index="1"></select><input class="catExtraHours" data-extra-index="1" type="number" step="0.25" min="0" /></div></label>
    <label>Extra kategori 2<div><select class="catExtraSelect" data-extra-index="2"></select><input class="catExtraHours" data-extra-index="2" type="number" step="0.25" min="0" /></div></label>
    <label><input id="traktChk" type="checkbox" /> Traktamente</label>
    <label>Projekt nr<input id="projektInput" type="text" /></label>
    <label>Körtid (h)<input id="driveHoursInput" type="number" step="0.25" min="0" /></label>
    <label style="grid-column:1/-1;">Dagboksanteckning<textarea id="noteInput" rows="2"></textarea></label>
  </div>
  <div class="button-row">
    <button id="saveEntryBtn"><i data-lucide="plus-circle"></i><span id="saveEntryLabel">Lägg till</span></button>
    <button id="manualBackupBtn2"><i data-lucide="upload-cloud"></i><span>Backup nu</span></button>
    <button id="cancelEditBtn" class="cancel-btn" style="display:none;"><i data-lucide="x-circle"></i><span>Avbryt</span></button>
  </div>
</section>

<section class="table-wrap">
<table id="monthTable">
<thead><tr><th>Datum</th><th>Projekt</th><th>Kategori(er)</th><th>Totaltid</th><th>Körtid</th><th>Dagboksanteckning</th><th>Åtgärd</th></tr></thead>
<tbody id="monthTableBody"></tbody>
<tfoot><tr><td colspan="7" id="monthSummaryCell"></td></tr></tfoot>
</table>
</section>

<section class="year-card">
<h3>Årsöversikt</h3>
<table id="yearTable">
<thead><tr><th>Månad</th><th>Ordinarie</th><th>Flex</th><th>ÖT&lt;2</th><th>ÖT&gt;2</th><th>Semester</th><th>ATF</th><th>VAB</th><th>Sjuk</th><th>Trakt</th><th>Körtid</th></tr></thead>
<tbody id="yearTableBody"></tbody>
</table>
</section>

<section class="year-card">
<h3>Larm (dagar som passerat)</h3>
<table><thead><tr><th>Datum</th><th>Tid</th><th>Status</th><th>Projekt</th></tr></thead><tbody id="alarmTableBody"></tbody></table>
</section>
</main>
</div>

<script src="balansregler.js"></script>
<script src="backup.js"></script>
<script src="export.js"></script>
<script src="search.js"></script>
<script src="app.js"></script>
<script>if(window.lucide){lucide.createIcons();}</script>
</body>
</html>